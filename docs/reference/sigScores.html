<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Score a Matrix by Gene sigs (Signatures) — sigScores • scalop</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Score a Matrix by Gene sigs (Signatures) — sigScores"><meta property="og:description" content="Score a Matrix by Gene sigs (Signatures). Raw scores are generated with scalop::baseScores (i.e. average expression level of genes in the signature in question). Options to normalise scores either by centering by the average expression level across all genes for each column of &amp;lt;m&amp;gt; (cells/samples) or by subtracting a score from an expression-bin-matched group. The default is the latter."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scalop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/01_intra_tumour_programs.html">1 Defining intra-tumour programs of heterogeneity</a>
    </li>
    <li>
      <a href="../articles/02_MGH136_programs_the_real_deal.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/old_01.html">1 Defining intra-tumour programs of heterogeneity</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jlaffy/scalop/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Score a Matrix by Gene sigs (Signatures)</h1>
    <small class="dont-index">Source: <a href="https://github.com/jlaffy/scalop/blob/HEAD/R/sigScores.R" class="external-link"><code>R/sigScores.R</code></a></small>
    <div class="hidden name"><code>sigScores.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Score a Matrix by Gene sigs (Signatures). Raw scores are generated with scalop::baseScores (i.e. average expression level of genes in the signature in question). Options to normalise scores either by centering by the average expression level across all genes for each column of &lt;m&gt; (cells/samples) or by subtracting a score from an expression-bin-matched group. The default is the latter.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sigScores</span><span class="op">(</span></span>
<span>  <span class="va">m</span>,</span>
<span>  <span class="va">sigs</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  center.rows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  expr.center <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  expr.bin.m <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  expr.bins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  expr.sigs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  expr.nbin <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  expr.binsize <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  conserved.genes <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  replace <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>m</dt>
<dd><p>a non-centered matrix of genes X cells/samples. The matrix will be row-centered internally prior to scoring.</p></dd>


<dt>sigs</dt>
<dd><p>a character vector of genes or list of character vectors. Sigs will be filtered to remove genes that are missing from rows in &lt;m&gt;.</p></dd>


<dt>groups</dt>
<dd><p>if scores should be calculated intra-tumour, a list of cell IDs by sample. Default: NULL</p></dd>


<dt>center</dt>
<dd><p>Only relevant if expr.center = FALSE. If TRUE, normalise the scores by subtracting  the mean expression level across all genes (i.e. centering). No scaling is performed. Set to FALSE i f not desired. If expr.center = T and center = T, expr.center takes precedence. Default: T</p></dd>


<dt>expr.center</dt>
<dd><p>normalise scores by subtracting scores generated from expression-bin-matched sigs. Set to FALSE if not desired. If expr.center = T and center = T, expr.center takes precedence. Default: T</p></dd>


<dt>expr.bin.m</dt>
<dd><p>if provided, this matrix will be used to bin the genes and generated expression-bin-matched sigs. Only relevant if expr.center = T. If NULL, &lt;m&gt; will be used. Default: NULL</p></dd>


<dt>expr.bins</dt>
<dd><p>if provided, these bins will be used to generated bin-matched sigs. Useful if you would like to use the same bins across several scoring analyses, or if your bins control for something other than global gene expression levels. Should be a vector of bin IDs with gene names as vector names. If NULL, will be computed from expr.bin.m (see above). Only relevant if expr.center = T. Default: NULL</p></dd>


<dt>expr.sigs</dt>
<dd><p>if provided, a character vector or list of character vectors of the same length as &lt;sigs&gt;. Scores with expr.sigs will be subtracted from the real group scores. If NULL and expr.center = T, these will be defined internally as expression-bin-matched sigs to correct the scores. Default: NULL</p></dd>


<dt>expr.nbin</dt>
<dd><p>if expr.center = T and the expr.sigs are to be generated from scratch, the number of desired expression bins. For example, you should make expr.nbin smaller if you have fewer genes, as you would like a good number of bin-matched genes in each bin group. Default: 30</p></dd>


<dt>expr.binsize</dt>
<dd><p>the number of bin-matched genes to take per gene in each group. Default: 100</p></dd>


<dt>conserved.genes</dt>
<dd><p>minimum fraction of genes retained in sigs after filtering that is allowed. sigs not passing this cutoff will not be used to score the matrix. This can be ignored if all genes in sigs are present in rownames(&lt;m&gt;). Default: 0.7</p></dd>


<dt>replace</dt>
<dd><p>if TRUE, the same bin-matched gene can be taken more than once for the control expr.group. Default: F</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a dataframe of cell/sample scores. Has the same number of rows as there are columns in &lt;m&gt; and the same number of columns as there are sigs to score (assumming no sigs are filtered out because of missing genes).</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Julie Laffy.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

