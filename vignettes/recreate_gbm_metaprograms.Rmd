---
title: "Recreating the GBM meta-programs"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(collapse = T, comment = "#>")
options(tibble.print_min = 4L, tibble.print_max = 4L)
knitr::opts_knit$set(warning = FALSE, error = TRUE)
#library(infercna)
library(magrittr)
set.seed(1014)
```

### 1. MGH136 expression programs toy example
##### 1.1. Load data
```{r}
?scalop::MGH136
head(scalop::MGH136)
```
##### 1.2. Center expression matrix
```{r}
MGH136.cent = scalop::rowcenter(scalop::MGH136)
```
##### 1.3. Generate an ordered correlation matrix
```{r}	
r.matrix = scalop::hca_cor(MGH136.cent)
```
##### 1.4. Retrieve cell clusters with a specified <\k>\
```{r}
clusters_4 = scalop::hca_groups(cr.matrix,
				k = 4,
				cor.method ='none',
				min.size = 0,
				max.size = 1)
```
##### 1.5. Define expression programs from each cell cluster
```{r}

```
##### 1.6. (*Revisiting 1.4.*)Retrieve cell clusters with no cutoff.
```{r}
```

### 2. MGH136 expression programs the real deal 

### Define expression programs from all tumours

### Cluster expression programs

## MSigDB gene set functional enrichments
